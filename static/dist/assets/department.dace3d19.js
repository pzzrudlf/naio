import{k as v,p as y,l as S,q as $,y as V,S as F,a as I,o as H,c as M,x as t,v as a,e,z as R,A as w,B as q,C as G,F as P,i as r,D as U,G as j,E as J}from"./index.8b30d168.js";import{E as K,a as L}from"./el-table-column.bddec628.js";import"./el-checkbox.4c6020a8.js";/* empty css                */import{E as O,a as Q}from"./el-form-item.78367822.js";import"./el-input.55b498ca.js";import{u as W,_ as X}from"./addAndEdit.12bde74c.js";import{g as Y,d as Z,a as ee,e as te}from"./parent.537a4f9b.js";import{E as f}from"./baseEnum.d65d91be.js";import"./useDialog.8d08ce90.js";import"./useSelectParent.5b1f63f6.js";import"./el-tree.6dd90539.js";function oe(){const l=v(0),i=y({searchName:""}),n=y({list:[]}),c=async()=>{const u=await Y(i);u&&u.code==200&&(n.list=u.data)};return S(()=>{c(),$(()=>{l.value=window.innerHeight-200})}),{searchForm:i,tableData:n,tableHeight:l,getDeptList:c}}function ne(l,i){const{global:n}=V(),c=v();return{searchBtn:()=>{console.log("searchBtn func"),l()},resetBtn:()=>{i.searchName="",l()},addBtn:()=>{var o;console.log("addBtn"),(o=c.value)==null||o.show(f.ADD)},editBtn:o=>{var s;console.log("editBtn func",o),(s=c.value)==null||s.show(f.EDIT,o)},deleteBtn:async o=>{console.log("deleteBtn func"),console.log(n);let s={id:o.id};if(await n.$myconfirm("\u786E\u5B9A\u5220\u9664\u8BE5\u6570\u636E\u5417?")){let m=await Z(s);m&&m.code==F.Success&&(n.$message({message:m.msg,type:"success"}),l())}},save:async o=>{console.log("\u4FDD\u5B58"),console.log(n),console.log(o);let s;o.type==f.ADD?s=await ee(o):s=await te(o),s&&s.code==F.Success&&(n.$message({message:s.msg,type:"success"}),l())},addAndEditDeptRef:c}}const se=r("\u67E5\u8BE2"),ae=r("\u91CD\u7F6E"),le=r("\u65B0\u589E"),ce=r("\u7F16\u8F91"),ie=r("\u5220\u9664"),Ce=I({name:"department",setup(l){const{rules:i}=W(),{searchForm:n,tableData:c,tableHeight:u,getDeptList:h}=oe(),{searchBtn:E,resetBtn:B,addBtn:g,editBtn:D,deleteBtn:o,save:s,addAndEditDeptRef:C}=ne(h,n);return(m,b)=>{const A=U,k=O,d=j,x=Q,p=K,T=L,z=J;return H(),M(P,null,[t(z,null,{default:a(()=>[t(x,{model:e(n),rules:e(i),"label-width":"80px",inline:!0,size:"small"},{default:a(()=>[t(k,null,{default:a(()=>[t(A,{modelValue:e(n).searchName,"onUpdate:modelValue":b[0]||(b[0]=_=>e(n).searchName=_),placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(k,null,{default:a(()=>[t(d,{icon:e(R),onClick:e(E)},{default:a(()=>[se]),_:1},8,["icon","onClick"]),t(d,{icon:e(w),onClick:e(B)},{default:a(()=>[ae]),_:1},8,["icon","onClick"]),t(d,{size:"small",type:"primary",icon:e(q),onClick:e(g)},{default:a(()=>[le]),_:1},8,["icon","onClick"])]),_:1})]),_:1},8,["model","rules"]),t(T,{height:e(u),data:e(c).list,style:{width:"100%"},"row-key":"id","default-expand-all":"",size:"medium",border:"","tree-props":{children:"children",hasChildren:"hasChildren"}},{default:a(()=>[t(p,{prop:"name",label:"\u90E8\u95E8\u540D\u79F0"}),t(p,{prop:"deptCode",label:"\u90E8\u95E8\u7F16\u7801"}),t(p,{prop:"deptPhone",label:"\u90E8\u95E8\u7535\u8BDD"}),t(p,{width:"200",align:"center",label:"\u64CD\u4F5C"},{default:a(_=>[t(d,{size:"small",type:"success",icon:e(G),onClick:N=>e(D)(_.row)},{default:a(()=>[ce]),_:2},1032,["icon","onClick"]),t(d,{size:"small",type:"danger",icon:e(w),onClick:N=>e(o)(_.row)},{default:a(()=>[ie]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["height","data"])]),_:1}),t(X,{ref_key:"addAndEditDeptRef",ref:C,onSave:e(s)},null,8,["onSave"])],64)}}});export{Ce as default};
