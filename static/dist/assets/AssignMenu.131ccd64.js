import{b1 as d,y as T,k as C,p as y,bn as _,a as A,o as b,s as v,v as x,x as E,e as r}from"./index.8b30d168.js";import{E as S}from"./el-tree.6dd90539.js";import"./el-checkbox.4c6020a8.js";import{u as O,S as D}from"./useDialog.8d08ce90.js";const z=async e=>await d.get("/api/role/list",e),H=async e=>await d.post("/api/role",e),N=async e=>await d.put("/api/role",e),U=async e=>await d.delete("/api/role",e),P=async e=>await d.get("/api/role/getAssignPermissionTree",e),I=async e=>await d.post("/api/role/roleAssignSave",e);function M(e,u,o){const{global:h}=T(),l=C(),g=y({children:"children",label:"label"}),a=y({list:[],assignTreeChecked:[]}),c=y({roleId:"",list:[]}),p=async()=>{var t,w;let s=((t=l.value)==null?void 0:t.getCheckedKeys(!1))||[],i=((w=l.value)==null?void 0:w.getHalfCheckedKeys())||[];c.list=s==null?void 0:s.concat(i);let n=await I(c);n&&n.code==200&&(h.$message({message:n.msg,type:"success"}),o())},f=(s,i)=>{a.list=[],a.assignTreeChecked=[],c.roleId=s;const n={roleId:s,userId:_()||""};m(n),e.height=420,e.width=300,e.title="\u4E3A\u3010"+i+"\u3011\u5206\u914D\u6743\u9650",u()},m=async s=>{let i=await P(s);if(i&&i.code==200&&(a.list=i.data.listmenu,a.assignTreeChecked=i.data.checkList,a.assignTreeChecked.length>0)){let n=[];a.assignTreeChecked.forEach(t=>{k(t,a.list,n)}),a.assignTreeChecked=n}},k=(s,i,n)=>{i.forEach(t=>{t.id==s?t.children&&t.children.length==0&&n.push(t.id):t.children&&t.children.length!=0&&k(s,t.children,n)})};return{confirm:p,show:f,assignTreeData:a,defaultProps:g,assignTree:l}}const R=A({name:"AssignMenu",setup(e,{expose:u}){const{dialog:o,onShow:h,onClose:l}=O(),{confirm:g,show:a,assignTreeData:c,defaultProps:p,assignTree:f}=M(o,h,l);return u({show:a}),(m,k)=>{const s=S;return b(),v(D,{title:r(o).title,width:r(o).width,height:r(o).height,visible:r(o).visible,onOnClose:r(l),onOnConfirm:r(g)},{content:x(()=>[E(s,{ref_key:"assignTree",ref:f,data:r(c).list,"node-key":"id",props:r(p),"empty-text":"\u6682\u65E0\u6570\u636E","show-checkbox":!0,"default-expand-all":"","highlight-current":!0,"default-checked-keys":r(c).assignTreeChecked},null,8,["data","props","default-checked-keys"])]),_:1},8,["title","width","height","visible","onOnClose","onOnConfirm"])}}});var V=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));export{V as A,R as _,H as a,U as d,N as e,z as g};
