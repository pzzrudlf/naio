import{p as x,l as F,b_ as j,y as q,k as y,b$ as G,c0 as J,c1 as K,a as O,q as Q,o as g,c as W,x as t,v as a,e,z as X,A as Y,a6 as B,s as E,B as Z,C as ee,bo as te,bp as ne,h as se,F as oe,i as d,c2 as ae,D as le,G as ie,E as re,c3 as ce,a4 as ue}from"./index.8b30d168.js";import{E as de}from"./el-select.60ad4b12.js";import"./el-input.55b498ca.js";import{E as me,a as pe}from"./el-table-column.bddec628.js";import"./el-checkbox.4c6020a8.js";/* empty css                */import{E as _e,a as ge}from"./el-form-item.78367822.js";import{E as v}from"./baseEnum.d65d91be.js";import fe from"./LeftTree.c28ce3c6.js";import Ce from"./AddAndEdit.e30c6ff3.js";import he from"./AssignRole.4cd2bee7.js";import"./index2.1260ca42.js";import"./el-tree.6dd90539.js";/* empty css                       */import"./el-radio.2829d223.js";import"./parent.537a4f9b.js";import"./useDialog.8d08ce90.js";import"./useSelectParent.5b1f63f6.js";function Be(){const r=x({deptId:"",currentPage:1,pageSize:10,loginName:"",total:0}),c=x({list:[]}),l=async()=>{let o=await j(r);console.log(o),o&&o.code==200&&(c.list=o.data.records,r.total=o.data.total)},i=o=>{console.log("\u7236\u7EC4\u4EF6\u6536\u5230"),r.deptId=o,l()},f=o=>{r.pageSize=o,l()},C=o=>{r.currentPage=o,l()};return F(()=>{l()}),{listParam:r,tableData:c,getUserList:l,treeClick:i,sizeChange:f,currentChange:C,searchBtn:()=>{l()},resetBtn:()=>{r.loginName="",l()}}}function Ee(r){const{global:c}=q(),l=y(),i=y();return{addBtn:()=>{var n;console.log("addBtn"),(n=i.value)==null||n.show(v.ADD)},editBtn:n=>{var s;console.log("editBtn",n),(s=i.value)==null||s.show(v.EDIT,n)},deleteBtn:async n=>{console.log("deleteBtn",n);let s={id:n};if(await c.$myconfirm("\u786E\u5B9A\u5220\u9664\u8BE5\u6570\u636E\u5417?")){let m=await G(s);m&&m.code==200&&(c.$message({message:m.msg,type:"success"}),r())}},assignBtn:n=>{var s;(s=l.value)==null||s.show(n.loginName,n.id)},save:async n=>{console.log("\u7236\u7EC4\u4EF6\u63A5\u6536\u7684\u53C2\u6570==>",n);let s;n.type==v.ADD?s=await J(n):s=await K(n),s&&s.code==200&&(r(),c.$message({message:s.msg,type:"success"}))},userAddRef:i,assignRoleRef:l}}const ye=d("\u641C\u7D22"),be=d("\u91CD\u7F6E"),ke=d("\u65B0\u589E"),ve=d("\u7F16\u8F91"),ze=d("\u5206\u914D\u89D2\u8272 "),we=d("\u5220\u9664 "),Je=O({name:"UserList",setup(r){const c=y(0),l=y(0),{listParam:i,tableData:f,treeClick:C,sizeChange:b,currentChange:k,getUserList:o,searchBtn:n,resetBtn:s}=Be(),{addBtn:z,editBtn:m,deleteBtn:T,assignBtn:$,userAddRef:N,save:R,assignRoleRef:U}=Ee(o);return F(()=>{Q(()=>{c.value=window.innerHeight-100,l.value=window.innerHeight-220})}),(De,w)=>{const S=ae,I=le,D=_e,u=ie,P=ge,p=me,V=pe,H=de,L=re,M=ce,h=ue("permission");return g(),W(oe,null,[t(M,{style:se({height:c.value+"px"})},{default:a(()=>[t(S,{width:"200px",style:{"border-right":"1px solid #dfe6ec"}},{default:a(()=>[t(fe,{ref:"userLeftTree",onTreeClick:e(C)},null,8,["onTreeClick"])]),_:1}),t(L,null,{default:a(()=>[t(P,{model:e(i),"label-width":"80px",inline:!0,size:"small"},{default:a(()=>[t(D,{label:""},{default:a(()=>[t(I,{modelValue:e(i).loginName,"onUpdate:modelValue":w[0]||(w[0]=_=>e(i).loginName=_)},null,8,["modelValue"])]),_:1}),t(D,null,{default:a(()=>[t(u,{size:"small",icon:e(X),onClick:e(n)},{default:a(()=>[ye]),_:1},8,["icon","onClick"]),t(u,{size:"small",icon:e(Y),onClick:e(s)},{default:a(()=>[be]),_:1},8,["icon","onClick"]),B((g(),E(u,{size:"small",icon:e(Z),type:"primary",onClick:e(z)},{default:a(()=>[ke]),_:1},8,["icon","onClick"])),[[h,["sys:user:add"]]])]),_:1})]),_:1},8,["model"]),t(V,{height:l.value,data:e(f).list,border:"",stripe:""},{default:a(()=>[t(p,{prop:"loginName",label:"\u7528\u6237\u540D"}),t(p,{prop:"deptName",label:"\u6240\u5C5E\u90E8\u95E8"}),t(p,{prop:"mobile",label:"\u7535\u8BDD"}),t(p,{prop:"email",label:"\u90AE\u7BB1"}),t(p,{align:"center",width:"290",label:"\u64CD\u4F5C"},{default:a(_=>[B((g(),E(u,{type:"primary",size:"small",icon:e(ee),onClick:A=>e(m)(_.row)},{default:a(()=>[ve]),_:2},1032,["icon","onClick"])),[[h,["sys:user:edit"]]]),B((g(),E(u,{type:"primary",size:"small",icon:e(te),onClick:A=>e($)(_.row)},{default:a(()=>[ze]),_:2},1032,["icon","onClick"])),[[h,["sys:user:assign"]]]),B((g(),E(u,{type:"danger",size:"small",icon:e(ne),onClick:A=>e(T)(_.row.id)},{default:a(()=>[we]),_:2},1032,["icon","onClick"])),[[h,["sys:user:delete"]]])]),_:1})]),_:1},8,["height","data"]),t(H,{onSizeChange:e(b),onCurrentChange:e(k),"current-page":e(i).currentPage,"page-sizes":[10,20,40,80,100],"page-size":e(i).pageSize,total:e(i).total,layout:"total, sizes, prev, pager, next, jumper",background:""},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]),_:1})]),_:1},8,["style"]),t(Ce,{ref_key:"userAddRef",ref:N,onSave:e(R)},null,8,["onSave"]),t(he,{ref_key:"assignRoleRef",ref:U},null,512)],64)}}});export{Je as default};
